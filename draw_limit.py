import matplotlib.pyplot as plt
import numpy as np

obs_mstau = np.array([312.12, 313.13, 314.43, 316.61, 318.18, 318.51, 319.97, 320.95, 321.48, 321.56, 321.24, 320.54, 319.49, 318.18, 318.09, 316.16, 313.92, 313.13, 311.05, 308.08, 307.77, 303.51, 303.03, 297.98, 297.73, 292.93, 287.88, 285.01, 282.83, 279.48, 277.78, 274.56, 272.73, 268.11, 267.68, 262.63, 257.58, 252.53, 251.86, 247.47, 242.42, 237.37, 237.35, 232.32, 227.27, 222.22, 217.17, 215.81, 212.12, 207.07, 204.79, 202.02, 197.65, 196.97, 191.92, 191.8, 186.87, 186.63, 181.82, 181.82, 177.35, 176.77, 173.22, 171.72, 169.49, 166.67, 166.18, 163.34, 161.62, 160.88, 158.83, 157.11, 156.57, 155.75, 154.73])

obs_mneu = np.array([0.0, 1.7606, 4.0407, 8.0814, 11.384, 12.122, 16.163, 20.203, 24.244, 28.285, 32.326, 36.366, 40.407, 44.21, 44.448, 48.488, 52.528999999999996, 53.816, 56.57, 60.32, 60.611000000000004, 64.65100000000001, 65.141, 68.612, 68.692, 70.602, 70.332, 68.692, 67.544, 64.65100000000001, 63.342, 60.611000000000004, 59.257, 56.57, 56.354, 55.081, 55.228, 56.332, 56.57, 57.838, 59.341, 60.607, 60.611000000000004, 61.449, 61.826, 61.681000000000004, 60.976000000000006, 60.611000000000004, 59.646, 57.711000000000006, 56.57, 55.17100000000001, 52.528999999999996, 52.11, 48.574, 48.488, 44.641000000000005, 44.448, 40.407, 40.403, 36.366, 35.797, 32.326, 30.71, 28.285, 24.855, 24.244, 20.203, 17.397000000000002, 16.163, 12.122, 8.0814, 6.4992, 4.0407, 0.0])

exp_mstau = np.array([297.15, 297.98, 298.99, 300.79, 302.59, 303.03, 304.21, 305.62, 306.77, 307.54, 307.84, 307.58, 306.73, 305.32, 303.42, 303.03, 300.69, 297.98, 297.58, 293.72, 292.93, 289.28, 287.88, 284.03, 282.83, 277.78, 274.51, 272.73, 267.68, 262.63, 257.58, 252.53, 247.47, 242.42, 237.37, 232.32, 227.27, 222.22, 217.46, 217.17, 212.12, 207.07, 206.4, 202.02, 199.19, 196.97, 193.03, 191.92, 187.24, 186.87, 181.82, 181.37, 176.77, 175.07, 171.72, 168.34, 166.67, 161.66, 161.62, 156.57, 155.83, 151.51, 151.07, 147.22, 146.47, 144.04, 141.41, 141.3, 139.03, 137.06, 136.36, 135.49, 134.3, 133.48])

exp_mneu = np.array([0.0, 1.7822, 4.0407, 8.0814, 12.122, 13.151, 16.163, 20.203, 24.244, 28.285, 32.326, 36.366, 40.407, 44.448, 48.488, 49.184, 52.528999999999996, 56.148, 56.57, 60.611000000000004, 61.489, 64.65100000000001, 65.98899999999999, 68.692, 69.624, 72.036, 72.733, 73.092, 73.248, 73.137, 73.145, 73.354, 73.70100000000001, 74.07600000000001, 74.365, 74.462, 74.267, 73.696, 72.733, 72.678, 71.126, 69.046, 68.692, 66.388, 64.65100000000001, 63.273, 60.611000000000004, 59.846000000000004, 56.57, 56.303000000000004, 52.815, 52.528999999999996, 49.498999999999995, 48.488, 46.397, 44.448, 43.42, 40.407, 40.376, 36.908, 36.366, 32.736999999999995, 32.326, 28.285, 27.381999999999998, 24.244, 20.386, 20.203, 16.163, 12.122, 10.383, 8.0814, 4.0407, 0.0])

onesig_plus_x = np.array([115.41, 119.46, 130.00, 146.22, 167.30,
                          189.19, 205.41, 222.43, 239.46, 254.05,
                          274.32, 292.97, 308.38, 317.30, 322.16,
                          326.22, 331.08, 335.14, 340.00, 345.68,
                          350.54, 357.03, 360.27, 363.51, 363.51, 364.32])
onesig_plus_y = np.array([0.00, 14.66, 35.08, 49.21, 59.42,
                          72.77, 83.77, 93.98, 107.33, 119.11,
                          130.89, 135.60, 133.25, 125.39, 117.54,
                          108.12, 96.34, 86.13, 75.92, 64.92,
                          56.28, 43.72, 34.29, 17.80, 0.00, 2.88])

onesig_minus_x = np.array([169.73, 173.78, 181.08, 185.95, 194.86,
                          202.97, 213.51, 220.81, 224.86, 223.24,
                          221.62, 217.57, 213.51, 207.84])
onesig_minus_y = np.array([0.00, 11.52, 20.16, 24.87, 31.94,
                          37.43, 41.36, 39.01, 31.94, 21.73,
                          17.80, 13.09, 7.59, 0.00])

m_th_x = np.array([80,180]) 
m_th_y = np.array([80,180])

accep_x = np.array([100,120,120,120,140,
                    180,200,220,250,250,
                    300,340,360,380])
accep_y = np.array([1,20,30,50,50,
                    80,100,100,120,150,
                    140,120,110,80])
rejec_x = np.array([120,140,140,160,180,
                    200,200,200,220,250,
                    250,280,300,300,300,
                    320,320,340,360,360,
                    360,360,])
rejec_y = np.array([1,1,30,1,60,
                    50,70,80,80,70,
                    100,1,70,100,120,
                    1,50,100,50,60,
                    80,100,])


tfont = {'fontname':'Nimbus Roman:style=Bold'}
fig, ax = plt.subplots()
plt.plot(obs_mstau, obs_mneu, antialiased=True, color='maroon', label='Observed (ATLAS)')
plt.plot(exp_mstau, exp_mneu, '--', antialiased=True, color='black', label='Expected (ATLAS)')
plt.plot(onesig_plus_x, onesig_plus_y, antialiased=True, color='gold', label='$\pm 1 \sigma$ (ATLAS)')
plt.plot(onesig_minus_x, onesig_minus_y, antialiased=True, color='gold')
plt.plot(m_th_x, m_th_y, '--', color='gray')
plt.plot(accep_x, accep_y, '+', color='green', label='Accepted (MA5)')
plt.plot(rejec_x, rejec_y, 'x', color='red', label='Rejected (MA5)')
plt.grid(True)
plt.xlim(80,450)
plt.ylim(0,270)
plt.xlabel(r'$m(\tilde{\tau})$ [GeV]', horizontalalignment='right', x=1.0)
plt.ylabel(r'$m(\tilde{\chi}^0_1)$ [GeV]', horizontalalignment='right', y=1.0)
plt.legend(loc='upper right', prop={'size': 8})
text_mass= r'$m(\tilde{\tau})$ < $m(\tilde{\chi}^0_1)$'
ax.text(0.10, 0.65, text_mass, rotation=45, color='gray',
        transform=ax.transAxes, fontsize=8, verticalalignment='top')
text = '\n'.join((
        r'MadAnalysis5 ATLAS-SYSY-2018-04',
        r'$\sqrt{s}$=13 TeV, 139 fb$^-1$',
        r'$\tilde{\tau}^{+}_{L}\tilde{\tau}^{-}_{L}\rightarrow 2 \times \tau \tilde{\chi}^0_1$',
        r'SR combined (ATLAS) and best of SR (MA5)'))
ax.text(0.05, 0.95, text,
        transform=ax.transAxes, fontsize=10, verticalalignment='top')#, **tfont)
plt.savefig('limit.pdf', bbox_inches='tight')
